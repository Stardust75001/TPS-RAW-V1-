{% comment %}
Section : Stories Bar Sticky Configurable (pr√©remplie)
{% endcomment %}

{% assign sort_order = section.settings.sort_order %}
<div class="stories-bar-wrapper{% if request.page_type == 'index' %} animate-slide-in{% endif %}">
  <div class="stories-bar">
    {% assign stories = section.blocks %}
    {% if sort_order == 'alphabetical' %}
      {% assign stories = section.blocks | sort: 'settings.title' %}
    {% endif %}

    {% assign size = section.settings.icon_size | default: 90 %}
    {% for block in stories %}
      <a href="{{ block.settings.link }}" class="animated-stories-link" style="--i:{{ forloop.index }}">
        {% if block.settings.image != blank %}
          <img
            src="{{ block.settings.image | image_url: width: size, height: size, crop: 'center' }}"
            alt="{{ block.settings.title | escape }}"
            width="{{ size }}"
            height="{{ size }}"
            loading="lazy"
          >
        {% endif %}
        <div
          class="tooltip-bubble"
          role="tooltip"
          style="background-color: {{ section.settings.tooltip_bg }}; opacity: {{ section.settings.tooltip_opacity }};">
          {{ block.settings.title }}
        </div>
      </a>
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "Stories Bar Sticky",
  "settings": [
    {
      "type": "select",
      "id": "icon_size",
      "label": "Icon size (px)",
      "default": "90",
      "options": [
        {
          "value": "60",
          "label": "60px"
        },
        {
          "value": "90",
          "label": "90px"
        },
        {
          "value": "120",
          "label": "120px"
        }
      ]
    },
    {
      "type": "color",
      "id": "tooltip_bg",
      "label": "Tooltip background color",
      "default": "#0F6378"
    },
    {
      "type": "range",
      "id": "tooltip_opacity",
      "label": "Tooltip opacity",
      "min": 0.1,
      "max": 1,
      "step": 0.1,
      "default": 1
    },
    {
      "type": "select",
      "id": "sort_order",
      "label": "Icon display order",
      "default": "manual",
      "options": [
        {
          "value": "manual",
          "label": "Manual order"
        },
        {
          "value": "alphabetical",
          "label": "Alphabetical order"
        }
      ]
    }
  ],
  "blocks": [
    {
      "type": "story",
      "name": "Story",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Collection name",
          "default": "SPA"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Icon"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Collection link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Stories Bar Sticky",
      "blocks": []
    }
  ]
}
{% endschema %}