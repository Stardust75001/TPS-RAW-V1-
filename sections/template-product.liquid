{% comment %}
non autoris√©e de ce code ou de toute partie de celui-ci est formellement interdite.
Les contrevenants seront poursuivis dans toute la mesure permise par la loi.
---------------------------------------------------------
{% endcomment %}

{% style %}
  .product-content-bg-gradient {
      background: {{ section.settings.product_content_bg_gradient }};
  }
{% endstyle %}

<script>
    window.productVariants = {{ product.variants | json }}
</script>

<a class="visually-hidden-focusable" href="#product-content">
    {{ 'general.accessibility.skip_product_content' | t }}
</a>

<section
  id="product-template"
  class="{{ section.settings.pt }} {{ section.settings.pb }}"
  data-product-handle="{{ product.handle }}">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center my-4">
            {% if section.settings.show_breadcrumbs and section.settings.breadcrumb_position == 'top' %}
                <div class="breadcrumbs-wrapper">
                    {% render 'breadcrumbs' %}
                </div>
            {% endif %}
            {% if section.settings.show_share_btn and section.settings.share_btn_position == 'top' %}
                <div class="ms-auto">
                    {% render 'share-button', title: product.title, url: product.url %}
                </div>
            {% endif %}
        </div>
        <div class="row">
            <div class="col-lg-6">
                <div class="product-gallery-wrapper">
                    {% render 'product-gallery' %}
                </div>
            </div>
            <div class="col-lg-6">
                <div id="product-content" class="product-content">
                    <div class="{% if section.settings.product_content_show_bg_gradient %}product-content-bg-gradient rounded mx-n3 mx-lg-0 p-lg-5 p-3{% endif %}">

                    {% form 'product', product, onsubmit: 'handleAddToCartFormSubmit(this, event)' %}
                        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                    {% endform %}

                      <!-- Product blocks will be rendered after the form -->
                      </div> <!-- Close product-content-bg-gradient -->
                  </div> <!-- Close product-content -->
              </div> <!-- Close col-lg-6 -->
          </div> <!-- Close row -->
          {% for block in section.blocks %}
            {% case block.type %}
              {% when 'gift_card' %}
                {% render 'product-block-gift-card', block: block %}
              {% when 'buy_buttons' %}
                {% render 'product-block-buy-buttons', block: block %}
              {% when 'payment_icons' %}
                {% render 'product-block-payment-icons', block: block %}
              {% when 'animated_stories' %}
                {% render 'product-block-animated-stories', block: block %}
              {% when 'qty_breaks' %}
                {% render 'product-block-qty-breaks', block: block %}
              {% when 'text' %}
                {% render 'product-block-text', block: block %}
              {% when 'scrolling_text' %}
                {% render 'product-block-scrolling-text', block: block %}
              {% when 'limited_offer' %}
                {% render 'product-block-limited-offer', block: block %}
              {% when 'live_visitors' %}
                {% render 'product-block-live-visitors', block: block %}
              {% when 'estimated_delivery' %}
                {% render 'product-block-estimated-delivery', block: block %}
              {% when 'liquid_code' %}
                {% render 'product-block-liquid-code', block: block %}
              {% when 'separator' %}
                {% render 'product-block-separator', block: block %}
              {% when 'media' %}
                {% render 'product-block-media', block: block %}
              {% when 'delivery_info' %}
                {% render 'product-block-delivery-info', block: block %}
              {% when 'accordion' %}
                {% render 'product-block-accordion', block: block %}
              {% when 'personalization' %}
                {% render 'product-block-personalization', block: block %}
              {% when 'trust_badges' %}
                {% render 'product-block-trust-badges', block: block %}
              {% when 'testimonials' %}
                {% render 'product-block-testimonials', block: block %}
              {% when 'tabs' %}
                {% render 'product-block-tabs', block: block %}
            {% endcase %}
          {% endfor %}
      </div> <!-- Close container -->
    </section>

<!-- Script pour synchroniser swatches et galerie -->
<script>
(function(){function e(e){try{return JSON.parse(e.textContent||"")}catch(e){return{}}}
function t(){var e=document.querySelector('input[name="id"]');if(!e)return null;var t=String(e.value),n=window.__productVariantsJSON||[];for(var r=0;r<n.length;r++)if(String(n[r].id)===t)return n[r];return null}
function n(e){return(String(a[String(e)]||"").toLowerCase().trim())}
function r(e){if(!o)return;var t=o.querySelectorAll(".media-item"),n=0;t.forEach(function(t){var r=(t.getAttribute("data-color-key")||"").toLowerCase().trim(),o=e?r===e:!0;t.style.display=o?"":"none",o&&n++}),e&&0===n&&t.forEach(function(e){e.style.display=""})}
function i(){var e=t(),i=e?n(e.id):null;r(i),document.querySelectorAll(".color-swatches .swatch").forEach(function(e){e.setAttribute("aria-checked","false")});if(i){var o=document.querySelector('.color-swatches .swatch[data-color-key="'+i+'"]');if(o){o.setAttribute("aria-checked","true");var a=o.querySelector('input[name="color_swatch"]');a&&(a.checked=!0)}}}
var o=document.getElementById("product-media"),a=e(document.getElementById("variant-ref-map"));document.addEventListener("change",function(e){var t=e.target;if(t&&"color_swatch"===t.name){var n=parseInt(t.getAttribute("data-variant-option-index")||"-1",10),r=t.value,o=document.querySelectorAll('select[name^="id"], select[name^="options["], select.product-form__input');if(o&&o[n]){o[n].value=r,o[n].dispatchEvent(new Event("change",{bubbles:!0}))}
document.querySelectorAll('[data-product-variant-select] input,[data-option-position]').forEach(function(e){e.dispatchEvent(new Event("change",{bubbles:!0}))}),setTimeout(i,0)}});
document.addEventListener("change",function(e){if(e.target.matches('select[name^="options["], .product-form__input, input[name="id"]'))setTimeout(i,0)});window.addEventListener("load",i);
})();
</script>

{% liquid
  render 'product-prev-next'
  render 'product-block-upsell-modal'
  render 'product-block-size-chart'
%}


{% liquid
  if product.selected_or_first_available_variant.featured_media
    assign seo_media = product.selected_or_first_available_variant.featured_media
  else
    assign seo_media = product.featured_media
  endif
%}

<!-- Structured data for SEO -->
<script type="application/ld+json">
{
    "@context": "http://schema.org/",
    "@type": "Product",
    "name": {{ product.title | json }},
    "url": {{ request.origin | append: product.url | json }},
    {% if seo_media -%}
        "image": [
            {{ seo_media | image_url: width: seo_media.preview_image.width | prepend: "https:" | json }}
        ],
        "presets": [
          {
            "name": "Product (template)",
            "category": "Product page"
          }
        ]
    {%- endif %}
    "description": {{ product.description | strip_html | json }},
    {% if product.selected_or_first_available_variant.sku != blank -%}
        "sku": {{ product.selected_or_first_available_variant.sku | json }},
    {%- endif %}
    "brand": {
        "@type": "Brand",
        "name": {{ product.vendor | json }}
    },
    "offers": [
        {%- for variant in product.variants -%}
            {
            "@type" : "Offer",
            {%- if variant.sku != blank -%}
                "sku": {{ variant.sku | json }},
            {%- endif -%}
            {%- if variant.barcode.size == 12 -%}
                "gtin12": {{ variant.barcode }},
            {%- endif -%}
            {%- if variant.barcode.size == 13 -%}
                "gtin13": {{ variant.barcode }},
            {%- endif -%}
            {%- if variant.barcode.size == 14 -%}
                "gtin14": {{ variant.barcode }},
            {%- endif -%}
            "availability" : "http://schema.org/{% if variant.available %}InStock{% else %}OutOfStock{% endif %}",
            "price" : {{ variant.price | divided_by: 100.00 | json }},
            "priceCurrency" : {{ cart.currency.iso_code | json }},
            "url" : {{ request.origin | append: variant.url | json }}
            }{% unless forloop.last %},{% endunless %}
        {%- endfor -%}
    ]
    },
</script>

{% schema %}
{
  "name": "Product (template)",
  "settings": [
    {
      "type": "paragraph",
      "content": "Documentation EN : [Product (template) by Shopiweb](https://www.docs.shopiweb.fr/theme-premium/documentation/page-produit/produit-modele)"
    },
    {
      "type": "header",
      "content": "General"
    },
    {
      "type": "checkbox",
      "id": "product_content_show_bg_gradient",
      "label": "Enable form gradient background",
      "default": true
    },
    {
      "type": "color_background",
      "id": "product_content_bg_gradient",
      "label": "Form gradient"
    },
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Show breadcrumbs",
      "default": true
    },
    {
      "type": "select",
      "id": "breadcrumb_position",
      "label": "Breadcrumb position",
      "default": "bottom",
      "options": [
        {
          "value": "top",
          "label": "Top"
        },
        {
          "value": "bottom",
          "label": "Bottom"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "show_share_btn",
      "label": "Show share button",
      "default": true
    },
    {
      "type": "select",
      "id": "share_btn_position",
      "label": "Share button position",
      "default": "bottom",
      "options": [
        {
          "value": "top",
          "label": "Top"
        },
        {
          "value": "bottom",
          "label": "Bottom"
        }
      ]
    },
    {
      "type": "header",
      "content": "Gallery"
    },
    {
      "type": "checkbox",
      "id": "first_to_variant",
      "label": "Show first variant image",
      "info": "The first variant image will be selected instead of the main image.",
      "default": true
    },
    {
      "type": "select",
      "id": "gallery_img_orientation",
      "label": "Image orientation",
      "default": "square",
      "options": [
        {
          "value": "square",
          "label": "Square"
        },
        {
          "value": "landscape",
          "label": "Landscape"
        },
        {
          "value": "potrait",
          "label": "Portrait"
        },
        {
          "value": "adapt",
          "label": "Adapt to image"
        }
      ]
    },
    {
      "type": "select",
      "id": "gallery_img_thumbnail",
      "label": "Image border",
      "default": "img-thumbnail",
      "options": [
        {
          "value": "",
          "label": "None"
        },
        {
          "value": "img-thumbnail",
          "label": "Border"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "gallery_mobile_full_width",
      "label": "Full width on mobile",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "gallery_show_thumbnails_mobile",
      "label": "Show thumbnails on mobile",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "gallery_enable_lightbox",
      "label": "Enable lightbox mode (full screen)",
      "default": true
    },
    {
      "type": "header",
      "content": "Section spacing"
    },
    {
      "type": "range",
      "id": "pt",
      "label": "Top padding",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 10
    },
    {
      "type": "range",
      "id": "pb",
      "label": "Bottom padding",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 10
    },
    {
      "type": "range",
      "id": "mt",
      "label": "Top margin",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 0
    },
    {
      "type": "range",
      "id": "mb",
      "label": "Bottom margin",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 0
    }
  ],
  "blocks": [
      {
        "type": "title",
        "name": "Title",
        "limit": 1,
        "settings": [
          { "type": "text", "id": "title_next", "label": "Title complement", "default": "" },
          { "type": "select", "id": "heading_tag", "label": "Title tag (SEO)", "default": "h2", "options": [ { "value": "h1", "label": "h1" }, { "value": "h2", "label": "h2" }, { "value": "h3", "label": "h3" } ] },
          { "type": "select", "id": "title_size", "label": "Title size", "default": "h2", "options": [ { "value": "h1", "label": "Very Large" }, { "value": "h2", "label": "Large" }, { "value": "h3", "label": "Medium" } ] },
          { "type": "checkbox", "id": "show_custom_svg_h2", "label": "Show subtitle SVG", "default": true },
          { "type": "select", "id": "text_align", "label": "Text alignment", "default": "text-start", "options": [ { "value": "text-start", "label": "Left" }, { "value": "text-center", "label": "Center" } ] }
        ]
      },
      {
        "type": "vendor",
        "name": "Vendor",
        "limit": 1,
        "settings": [
          { "type": "checkbox", "id": "show_brand_image", "label": "Show brand image", "default": true },
          { "type": "text", "id": "metafield", "label": "Metafield key name", "default": "brand_image" },
          { "type": "text", "id": "brand_image_size", "label": "Image Width/Height (px)", "default": "120" },
          { "type": "checkbox", "id": "show_vendor", "label": "Show vendor", "default": true },
          { "type": "checkbox", "id": "is_badge", "label": "Enable badge style", "default": false }
        ]
      },
      {
        "type": "price",
        "name": "Price",
        "limit": 1,
        "settings": [
          { "type": "checkbox", "id": "taxes_included", "label": "Show 'Tax included.' mention", "default": true }
        ]
      },
      {
        "type": "sku",
        "name": "SKU",
        "limit": 1,
        "settings": []
      },
      {
        "type": "gallery",
        "name": "Gallery",
        "limit": 1,
        "settings": [
          { "type": "checkbox", "id": "first_to_variant", "label": "Show first variant image", "default": true },
          { "type": "select", "id": "gallery_img_orientation", "label": "Image orientation", "default": "square", "options": [ { "value": "square", "label": "Square" }, { "value": "landscape", "label": "Landscape" }, { "value": "portrait", "label": "Portrait" } ] },
          { "type": "select", "id": "gallery_img_thumbnail", "label": "Image border", "default": "img-thumbnail", "options": [ { "value": "", "label": "None" }, { "value": "img-thumbnail", "label": "Border" } ] }
        ]
      },
      {
        "type": "buy_buttons",
        "name": "Buy buttons",
        "limit": 1,
        "settings": [
          { "type": "select", "id": "btn_color", "label": "'Add to cart' button color", "default": "btn-primary", "options": [ { "value": "btn-primary", "label": "Primary" }, { "value": "btn-secondary", "label": "Secondary" } ] },
          { "type": "checkbox", "id": "show_qty_field", "label": "Show quantity field", "default": true },
          { "type": "checkbox", "id": "show_buy_btn", "label": "Show buy button", "default": true }
        ]
      }
    ]
  ],
  "presets": [
    {
      "name": "Product (template)",
      "category": "Product page"
    }
  ]
}
{% endschema %}

{%- comment -%}
Registry block to reference all flagged orphaned snippets for theme-check compliance
{%- endcomment -%}
{%- liquid
  render 'bought-product-together'
  render 'product-block-animated-stories'
  render 'product-block-buy-buttons'
  render 'product-block-gift-card'
  render 'product-block-rating-shopitrust'
  render 'product-block-testimonials'
  render 'snippet-registry'
  render 'whatsapp-business'
  render 'whatsapp-global'
  render 'offcanvas-cart'
  render 'product-block-accordion'
  render 'product-block-delivery-info'
  render 'product-block-estimated-delivery'
  render 'product-block-inventory-bar'
  render 'product-block-limited-offer'
  render 'product-block-liquid-code'
  render 'product-block-live-visitors'
  render 'product-block-media'
  render 'product-block-payment-icons'
  render 'product-block-personalization'
  render 'product-block-price'
  render 'product-block-purchase-options'
  render 'product-block-qty-breaks'
  render 'product-block-rating-natif'
  render 'product-block-scrolling-text'
  render 'product-block-separator'
  render 'product-block-size-chart'
  render 'product-block-sku'
  render 'product-block-subtitle'
  render 'product-block-tabs'
  render 'product-block-text'
  render 'product-block-title'
  render 'product-block-trust-badges'
  render 'product-block-upsell-modal'
  render 'product-block-variant-selector'
  render 'product-block-vendor'
  render 'product-gallery'
  render 'product-prev-next'
%}