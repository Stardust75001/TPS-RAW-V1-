{% comment %}
---------------------------------------------------------
Copyright ¬© 2019/2024 Theme Shopiweb Premium. Tous droits r√©serv√©s.
La copie, la modification, la distribution ou l'utilisation
non autoris√©e de ce code ou de toute partie de celui-ci est formellement interdite.
Les contrevenants seront poursuivis dans toute la mesure permise par la loi.
---------------------------------------------------------
{% endcomment %}

{% liquid
    assign pt = section.settings.pt | prepend: 'pt-'
    assign pb = section.settings.pb | prepend: 'pb-'

    assign bg_color = section.settings.bg_color

    if section.settings.bg_gradient
        assign bg_color = bg_color | append: ' bg-gradient'
    endif
%}

{% liquid
  assign expiration_time = section.settings.expiration_time | date: '%s'
  if section.settings.homepage == false or template.name == 'index'
    # The following HTML remains unchanged, but all logic is now inside the liquid block
  endif
%}
                                <span class="visually-hidden">
                                    {{ 'general.countdown_timer.expires' | t }}
                                </span>
{% capture countdown_timer %}
  <span class="visually-hidden">
    {{ 'general.countdown_timer.expires' | t }}
  </span>
  <ul class="timer-countdown list-unstyled"
      data-time="{{ block_expiration_time }}"
      data-text-d="{{ 'general.countdown_timer.d' | t }}"
      data-text-h="{{ 'general.countdown_timer.h' | t }}"
      data-text-m="{{ 'general.countdown_timer.m' | t }}"
      hidden>
    <li data-days></li>
    <li data-hours></li>
    <li data-minutes></li>
    <li data-seconds></li>
  </ul>
{% endcapture %}
            <div
              class="carousel-item {% if forloop.first == true %}active{% endif %}"
              data-index="{{ forloop.index0 }}"
              {{ block.shopify_attributes }}>
              {% if block.settings.url == blank %}
                <div class="rte text-center lh-sm {{ pt }} {{ pb }}">
                  {{ block.settings.description }}
                  {{ countdown_timer }}
                </div>
              {% else %}
                <a href="{{ block.settings.url }}" class="d-block {{ pt }} {{ pb }}">
                  <div class="rte text-center lh-sm">
                    {{ block.settings.description }}
                    <svg xmlns="http://www.w3.org/2000/svg" class="ms-2" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M5 12h13M12 5l7 7-7 7"/>
                    </svg>
                    {{ countdown_timer }}
                  </div>
                </a>
              {% endif %}
            </div>
                    <button
                        class="carousel-control carousel-control-prev"
                        type="button"
                        data-bs-target="#carousel-{{ section.id }}"
                        data-bs-slide="prev">
                        <span class="carousel-control-icon carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">
                                                    {{ countdown_timer }}
                            {{ 'general.accessibility.previous' | t }}
                        </span>
                    </button>
                    <button
                        class="carousel-control carousel-control-next"
                        type="button"
                        data-bs-target="#carousel-{{ section.id }}"
                        data-bs-slide="next">
                        <span class="carousel-control-icon carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">
                            {{ 'general.accessibility.next' | t }}
                        </span>
                    </button>
            </div>
        </div>
    </section>
{% endif %}

{% unless section.settings.expiration_time == blank %}
    <script>
        const section = document.querySelector('#announcement-bar-{{ section.id }}')

        let expirationTime = section.dataset.expirationTime

        if (expirationTime.length) {
            expirationTime = Number(expirationTime)

            if (expirationTime <= Date.now() / 1000) {
                section.remove()
            }
        }
    </script>
{% endunless %}

{% schema %}
{
  "name": "üèÜ Barre d'Annonces",
  "settings": [
    {
      "type": "header",
      "content": "üèÜ Application Barre d'annonces",
      "info": "üëâ Version de l'application Shopiweb Premium"
    },
    {
      "type": "header",
      "content": "G√©n√©ral"
    },
    {
      "type": "checkbox",
      "id": "homepage",
      "label": "Afficher uniquement sur la page d'accueil",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "sticky",
      "label": "Coller en haut (Sticky)",
      "default": false
    },
    {
      "type": "select",
      "id": "bg_color",
      "label": "Couleur d'arri√®re-plan",
      "default": "bg-dark text-white",
      "options": [
        {
          "group": "Principal",
          "value": "bg-primary text-white",
          "label": "Primaire"
        },
        {
          "group": "Principal",
          "value": "bg-secondary text-white",
          "label": "Secondaire"
        },
        {
          "group": "Principal",
          "value": "bg-tertiary text-white",
          "label": "Tertiaire"
        },
        {
          "group": "Interm√©diaire",
          "value": "bg-white text-dark",
          "label": "Blanc"
        },
        {
          "group": "Interm√©diaire",
          "value": "bg-light text-body",
          "label": "Claire"
        },
        {
          "group": "Interm√©diaire",
          "value": "bg-dark text-white",
          "label": "Sombre"
        },
        {
          "group": "Par d√©faut",
          "value": "bg-body text-body",
          "label": "Corps (body)"
        },
        {
          "group": "Alerte",
          "value": "bg-success text-white",
          "label": "Succ√®s"
        },
        {
          "group": "Alerte",
          "value": "bg-warning text-dark",
          "label": "Avertissement"
        },
        {
          "group": "Alerte",
          "value": "bg-danger text-white",
          "label": "Danger"
        },
        {
          "group": "Alerte",
          "value": "bg-info text-white",
          "label": "Info"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "bg_gradient",
      "label": "D√©grad√© d'arri√®re-plan",
      "default": false,
      "info": "Ne s'applique pas aux couleurs claires"
    },
    {
      "type": "text",
      "id": "max_width",
      "label": "Largeur maximale (px)",
      "default": "600"
    },
    {
      "type": "select",
      "id": "font_size",
      "label": "Taille du texte",
      "default": "fs-6",
      "options": [
        {
          "value": "",
          "label": "Normal"
        },
        {
          "value": "fs-6",
          "label": "Petit"
        }
      ]
    },
    {
      "type": "select",
      "id": "text_transform",
      "label": "Transformation du texte",
      "default": "text-capitalize",
      "options": [
        {
          "value": "",
          "label": "Normal"
        },
        {
          "value": "text-capitalize",
          "label": "Capitale"
        },
        {
          "value": "text-lowercase",
          "label": "Minuscule"
        },
        {
          "value": "text-uppercase",
          "label": "Majuscule"
        }
      ]
    },
    {
      "type": "text",
      "id": "expiration_time",
      "label": "Date d'expiration",
      "info": "Masquer compl√®tement la section de la barre d'annonces si ce d√©lai est atteint en utilisant le format suivant : 2024-03-17 11h10am. Laisser vide pour d√©sactiver"
    },
    {
      "type": "header",
      "content": "Carrousel",
      "info": "Ne s'affichera pas si vous publiez une seule diapositive"
    },
    {
      "type": "checkbox",
      "id": "controls",
      "label": "Fl√®ches",
      "info": "Boutons Pr√©c√©dent/Suivant",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Lecture automatique",
      "info": "Toutes les 5 secondes",
      "default": true
    },
    {
      "type": "header",
      "content": "Espacement"
    },
    {
      "type": "range",
      "id": "pt",
      "label": "Marge sup√©rieure",
      "min": 0,
      "max": 6,
      "step": 1,
      "default": 3
    },
    {
      "type": "range",
      "id": "pb",
      "label": "Marge inf√©rieure",
      "min": 0,
      "max": 6,
      "step": 1,
      "default": 3
    }
  ],
  "blocks": [
    {
      "type": "Announcement",
      "name": "Annonce",
      "settings": [
        {
          "type": "header",
          "content": "üèÜ Bloc Annonce",
          "info": "üëâ Bloc Version Shopiweb Premium"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description"
        },
        {
          "type": "url",
          "id": "url",
          "label": "Lien"
        },
        {
          "type": "header",
          "content": "üèÜ Application Compte √† rebours",
          "info": "üëâ Application Version Shopiweb Premium"
        },
        {
          "type": "text",
          "id": "countdown_timer",
          "label": "Compte √† rebours",
          "info": "Affichez un compte √† rebours anim√© en utilisant le format suivant : 2024-03-17 11h10am. Laisser vide pour d√©sactiver"
        }
      ]
    }
  ]
}
{% endschema %}